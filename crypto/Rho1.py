# -*- coding: utf-8 -*-
"""
Created on Mon Nov 29 21:15:16 2021

@author: JUXY
"""
import gmpy2
from Crypto.Util.number import *
base = 1
for i in range(2,1000):
    base*=i
def gcd(a,b):
    if a%b == 0:
        return b
    return gcd(b,a%b)
def rho_1(n):
    p = pow(2,base,n)-1
    p = gcd(p,n)
    q = n//p
    return p,q
def rsa(p,q,c,e):
    print("p="+str(p))
    print("q="+str(q))
    d = gmpy2.invert(e,(p-1)*(q-1))
    m = pow(c,d,p*q)
    print(m)
    return (long_to_bytes(m)) 

n1 = 0x808627CED38A980D765454AC5DFEFC10195F6FEF9B35B52B742DBCE2419C34080A3EF3E9673FEA4DD629FF382155031EA6DCBA8372D42C1862F32B2BEE47E157FA7150C544635035F366F7D68234F56FA24180EB6A00A0F85C65AAEB455B8ED28F2285376CDA786F8C658CFEB3752F3504A7256EA3DBD22EEF20267D156FAB51
e1 = 0x10001
c1 = 0x38702EF6FD51CA1CA834EF495618DA956C8F8AD222B99E256ED5E3DD9089E194DE67FD427F6132715709830A73B1A1CB582E56D06AF8F31BBA2851DBA1A1C2985B7FC233018E42554C2AABD69A225F9283A164C3AA5479363F89260219F9964738B7C78C5D08618009F3904EB55A6A570E8D4B1701F4BF1B2C99C7887CCFF2C9

p,q = rho_1(n1) 
print(rsa(p,q,c1,e1))

    